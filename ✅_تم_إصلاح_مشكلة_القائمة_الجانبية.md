# โ ุชู ุฅุตูุงุญ ูุดููุฉ ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ูููุณุชุฎุฏู ali
# Fixed Sidebar Menu Issue for User ali

---

## ๐ **ุงููุดููุฉ ุงูุฃุตููุฉ:**

### **ุงูุฃุนุฑุงุถ:**
โ ุงููุณุชุฎุฏู `ali` ูุฏูู ุฏูุฑ `manager` ูุน 117 ุตูุงุญูุฉ
โ ููู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ุชุนุฑุถ ููุท ุจุนุถ ุงูุนูุงุตุฑ:
  - โ ุงูุฑุฆูุณูุฉ (Home)
  - โ ุงููุดุชุฑูุงุช (Purchases)
  - โ ุงููุญุงุณุจุฉ (Accounting)
  - โ Banking
  - โ ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ (HR)
  - โ ุงูุชูุงุฑูุฑ (Reports)
  - โ ุงูุฅุนุฏุงุฏุงุช (Settings)

โ ุงูุนูุงุตุฑ ุงูููููุฏุฉ:
  - โ ุงููุฎุฒูู (Inventory)
  - โ ุงููุจูุนุงุช (Sales)
  - โ ููุงุท ุงูุจูุน (POS)

---

## ๐ **ุงูุณุจุจ ุงูุฌุฐุฑู:**

### **ุชุญููู ุงููุดููุฉ:**

ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ูู `app/templates/base.html` ุชุชุญูู ูู ุตูุงุญูุงุช ูุญุฏุฏุฉ:

```html
{% if current_user.has_permission('inventory.view') %}
    <!-- ุนุฑุถ ูุงุฆูุฉ ุงููุฎุฒูู -->
{% endif %}

{% if current_user.has_permission('sales.view') %}
    <!-- ุนุฑุถ ูุงุฆูุฉ ุงููุจูุนุงุช -->
{% endif %}

{% if current_user.has_permission('pos.access') %}
    <!-- ุนุฑุถ ูุงุฆูุฉ ููุงุท ุงูุจูุน -->
{% endif %}
```

### **ุงููุดููุฉ:**
ุงููุณุชุฎุฏู `ali` (ุฏูุฑ `manager`) ูุงู ูุฏูู:
- โ `inventory.products.view` - ุตูุงุญูุฉ ุนุฑุถ ุงูููุชุฌุงุช
- โ `inventory.categories.view` - ุตูุงุญูุฉ ุนุฑุถ ุงููุฆุงุช
- โ `inventory.stock.view` - ุตูุงุญูุฉ ุนุฑุถ ุงููุฎุฒูู
- โ **ููู ููุณ ูุฏูู `inventory.view`** - ุงูุตูุงุญูุฉ ุงูุฃุณุงุณูุฉ!

ููุณ ุงููุดููุฉ ูุน:
- โ `sales.view` - ููููุฏุฉ
- โ `pos.access` - ููููุฏุฉ

---

## โ **ุงูุญู ุงููุทุจู:**

### **ุงูุฎุทูุฉ 1: ุฅุถุงูุฉ ุงูุตูุงุญูุงุช ุงูููููุฏุฉ**

ุชู ุฅุถุงูุฉ 3 ุตูุงุญูุงุช ุฌุฏูุฏุฉ ุฅูู ุฌุฏูู `permissions`:

| ID  | Name           | Name (AR)              | Module    |
|-----|----------------|------------------------|-----------|
| 118 | inventory.view | ุนุฑุถ ุงููุฎุฒูู            | inventory |
| 119 | sales.view     | ุนุฑุถ ุงููุจูุนุงุช           | sales     |
| 120 | pos.access     | ุงููุตูู ูููุทุฉ ุงูุจูุน     | pos       |

### **ุงูุฎุทูุฉ 2: ุฅุถุงูุฉ ุงูุตูุงุญูุงุช ูุฏูุฑ manager**

ุชู ุฅุถุงูุฉ ุงูุตูุงุญูุงุช ุงูุซูุงุซุฉ ุฅูู ุฏูุฑ `manager`:

```sql
INSERT INTO role_permissions (role_id, permission_id) VALUES (2, 118);
INSERT INTO role_permissions (role_id, permission_id) VALUES (2, 119);
INSERT INTO role_permissions (role_id, permission_id) VALUES (2, 120);
```

### **ุงููุชูุฌุฉ:**
- โ ุฏูุฑ `manager` ุงูุขู ูุฏูู **120 ุตูุงุญูุฉ** (ุจุฏูุงู ูู 117)
- โ ุงููุณุชุฎุฏู `ali` ุงูุขู ูุฏูู ุฌููุน ุงูุตูุงุญูุงุช ุงูุฃุณุงุณูุฉ

---

## ๐ **ุงูุชุญูู ูู ุงูุฅุตูุงุญ:**

### **ูุจู ุงูุฅุตูุงุญ:**
```
Testing permissions:
  YES - dashboard.view
  NO  - inventory.view     โ
  NO  - sales.view         โ
  YES - purchases.view
  YES - accounting.view
  YES - hr.view
  YES - reports.view
  YES - settings.view
  NO  - pos.access         โ
```

### **ุจุนุฏ ุงูุฅุตูุงุญ:**
```
Testing permissions:
  YES - dashboard.view     โ
  YES - inventory.view     โ
  YES - sales.view         โ
  YES - purchases.view     โ
  YES - accounting.view    โ
  YES - hr.view            โ
  YES - reports.view       โ
  YES - settings.view      โ
  YES - pos.access         โ
```

---

## ๐ **ุงููููุงุช ุงููุณุชุฎุฏูุฉ:**

### **1. check_ali_permissions.py**
- **ุงูุบุฑุถ:** ุงูุชุญูู ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู ali
- **ุงูุงุณุชุฎุฏุงู:** `python check_ali_permissions.py`

### **2. fix_missing_permissions.py**
- **ุงูุบุฑุถ:** ุฅุถุงูุฉ ุงูุตูุงุญูุงุช ุงูููููุฏุฉ
- **ุงูุงุณุชุฎุฏุงู:** `python fix_missing_permissions.py`
- **ูุง ููุนูู:**
  1. ุฅุถุงูุฉ ุงูุตูุงุญูุงุช ุงูุซูุงุซุฉ ุงูููููุฏุฉ
  2. ุฅุถุงูุชูุง ูุฏูุฑ manager
  3. ุงูุชุญูู ูู ุงููุชูุฌุฉ

---

## ๐ฏ **ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ุงูุขู:**

### **ุงูุนูุงุตุฑ ุงููุนุฑูุถุฉ ูููุณุชุฎุฏู ali:**

1. โ **ุงูุฑุฆูุณูุฉ** (Home) - `dashboard.view`
2. โ **ุงููุฎุฒูู** (Inventory) - `inventory.view` โ **ุชู ุงูุฅุตูุงุญ!**
   - ุงูููุชุฌุงุช
   - ุงููุฆุงุช
   - ุงููุฎุงุฒู
   - ุงูุญุฑูุงุช
3. โ **ุงููุจูุนุงุช** (Sales) - `sales.view` โ **ุชู ุงูุฅุตูุงุญ!**
   - ุงูููุงุชูุฑ
   - ุงูุนููุงุก
   - ุนุฑูุถ ุงูุฃุณุนุงุฑ
4. โ **ุงููุดุชุฑูุงุช** (Purchases) - `purchases.view`
   - ููุงุชูุฑ ุงูุดุฑุงุก
   - ุงูููุฑุฏูู
5. โ **ููุงุท ุงูุจูุน** (POS) - `pos.access` โ **ุชู ุงูุฅุตูุงุญ!**
   - ุดุงุดุฉ ููุทุฉ ุงูุจูุน
   - ุงูุฌูุณุงุช
6. โ **ุงููุญุงุณุจุฉ** (Accounting) - `accounting.view`
7. โ **Banking** - `accounting.bank_accounts.view`
8. โ **ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ** (HR) - `hr.view`
9. โ **ุงูุชูุงุฑูุฑ** (Reports) - `reports.view`
10. โ **ุงูุฅุนุฏุงุฏุงุช** (Settings) - `settings.view`

---

## ๐ง **ูููุทูุฑูู:**

### **ููุงุญุธุฉ ูููุฉ:**
ุนูุฏ ุฅูุดุงุก ุฃุฏูุงุฑ ุฌุฏูุฏุฉุ ุชุฃูุฏ ูู ุฅุถุงูุฉ ุงูุตูุงุญูุงุช ุงูุฃุณุงุณูุฉ:

```python
# ุงูุตูุงุญูุงุช ุงูุฃุณุงุณูุฉ ุงููุทููุจุฉ ูุนุฑุถ ุงูููุงุฆู ุงูุฑุฆูุณูุฉ
base_permissions = [
    'dashboard.view',      # ููุญุฉ ุงูุชุญูู
    'inventory.view',      # ุงููุฎุฒูู
    'sales.view',          # ุงููุจูุนุงุช
    'purchases.view',      # ุงููุดุชุฑูุงุช
    'accounting.view',     # ุงููุญุงุณุจุฉ
    'hr.view',             # ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ
    'reports.view',        # ุงูุชูุงุฑูุฑ
    'settings.view',       # ุงูุฅุนุฏุงุฏุงุช
    'pos.access',          # ููุงุท ุงูุจูุน
]
```

### **ููููุฉ ุงูุชุญูู ูู ุงูุตูุงุญูุงุช:**

```python
from app.models import User

# Get user
user = User.query.filter_by(username='ali').first()

# Check permission
if user.has_permission('inventory.view'):
    print('User can access inventory menu')
else:
    print('User cannot access inventory menu')
```

---

## โ **ุงูุฎูุงุตุฉ:**

### **ุชู ุจูุฌุงุญ:**
- โ ุฅุถุงูุฉ 3 ุตูุงุญูุงุช ุฃุณุงุณูุฉ ููููุฏุฉ
- โ ุฅุถุงูุชูุง ูุฏูุฑ manager
- โ ุงููุณุชุฎุฏู ali ุงูุขู ูุฑู ุงููุงุฆูุฉ ุงููุงููุฉ
- โ ุฌููุน ุงูุตูุงุญูุงุช ุชุนูู ุจุดูู ุตุญูุญ

### **ุงููุชูุฌุฉ ุงูููุงุฆูุฉ:**
๐ **ุงููุณุชุฎุฏู ali ุงูุขู ูุฏูู ูุตูู ูุงูู ูุฌููุน ุฃูุณุงู ุงููุธุงู!**

---

**ุชุงุฑูุฎ ุงูุฅุตูุงุญ:** 2026-02-14
**ุงูุญุงูุฉ:** โ ููุชูู ููุนูู ุจูุฌุงุญ

